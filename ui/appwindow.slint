import { Button, VerticalBox , HorizontalBox, LineEdit, ListView, CheckBox} from "std-widgets.slint";

export struct ReviewTodoItem  {
    text: string,
    isFixed: bool,
}

export component AppWindow inherits Window {
    in property <[ReviewTodoItem]> review-todo-item-model: [];
    in property <string> current-file: "";
    property <bool> file-loaed: current-file != "";
    callback review-todo-added(string);
    callback review-todo-text-changed(int, string);
    callback review-todo-is-fixed-toggled(int);
    callback review-todos-save-requested <=> save-button.clicked;
    callback review-todos-open-requested <=> open-button.clicked;

    width: 600px;
    height: 600px;

    VerticalBox {
        LineEdit {
            horizontal-alignment: TextHorizontalAlignment.center;
            text: root.current-file;
            read-only: true;
        }
        HorizontalBox {
            open-button := Button { text: "Open"; enabled: !root.file-loaed;}
            save-button := Button { text: "Save"; }
        }
        LineEdit {
            placeholder-text: "Add comment here...";
            accepted => {
                if (self.text != "") {
                    root.review-todo-added(self.text);
                    self.text = "";
                }
            }
        }
        ListView {
            for data[idx] in review-todo-item-model : HorizontalBox {
                CheckBox {
                    checked: data.isFixed;
                    toggled => {
                        root.review-todo-is-fixed-toggled(idx);
                    }
                }
                LineEdit {
                    text: data.text;
                    accepted => {
                        root.review-todo-text-changed(idx, self.text);
                    }
                }
            }
        }
    }
}
